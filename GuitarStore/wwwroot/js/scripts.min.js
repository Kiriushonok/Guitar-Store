document.addEventListener("DOMContentLoaded",()=>{const t=document.getElementById("filter-form"),n=document.querySelectorAll(".product-card-box"),r=[{element:n[0],name:"Yamaha F310",price:25e3,type:"acoustic",brand:"yamaha"},{element:n[1],name:"Fender Stratocaster",price:12e4,type:"electric",brand:"fender"},{element:n[2],name:"Ibanez GSR200",price:8e4,type:"bass",brand:"ibanez"},{element:n[3],name:"Gibson Les Paul",price:14e4,type:"electric",brand:"gibson"},{element:n[4],name:"Fender Precision Bass",price:9e4,type:"bass",brand:"fender"},{element:n[5],name:"Gibson Les Paul Standard",price:15e4,type:"electric",brand:"gibson"}];t.addEventListener("submit",n=>{n.preventDefault();const f=t["guitar-type"].value;let i=parseInt(t["price-min"].value),u=parseInt(t["price-max"].value);const e=t.brand.value;if(isNaN(i)&&(i=0),isNaN(u)&&(u=Infinity),i>u){alert("Некорректные фильтры по цене: минимальная цена больше максимальной.");return}r.forEach(n=>{const t=f===""||n.type===f,r=n.price>=i&&n.price<=u,o=e===""||n.brand===e;n.element.style.display=t&&r&&o?"block":"none"})});const i=document.getElementById("back-to-top");window.addEventListener("scroll",()=>{i.style.display=window.scrollY>300?"block":"none"});i.addEventListener("click",()=>{window.scrollTo({top:0,behavior:"smooth"})})});document.getElementById("service-form").addEventListener("submit",function(n){n.preventDefault();let t=!0;const f=document.getElementById("guitar-brand").value.trim(),e=document.getElementById("guitar-type").value.trim(),o=document.getElementById("guitar-model").value.trim(),i=document.getElementById("year").value.trim(),r=document.getElementById("price").value.trim(),u=document.getElementById("guitar-photo").files[0];document.querySelectorAll(".error").forEach(n=>n.textContent="");document.getElementById("success-message").textContent="";f||(document.getElementById("guitar-brand-error").textContent="Введите бренд гитары.",t=!1);e||(document.getElementById("guitar-type-error").textContent="Введите тип гитары.",t=!1);o||(document.getElementById("guitar-model-error").textContent="Введите модель гитары.",t=!1);const s=(new Date).getFullYear();(!/^\d{4}$/.test(i)||i<2e3||i>s)&&(document.getElementById("year-error").textContent="Год выпуска должен быть в диапазоне от 2000 до текущего года.",t=!1);(!/^\d+$/.test(r)||r<=0)&&(document.getElementById("price-error").textContent="Введите корректную цену в рублях.",t=!1);u?["image/jpeg","image/png"].includes(u.type)||(document.getElementById("guitar-photo-error").textContent="Фото должно быть в формате .jpg или .png.",t=!1):(document.getElementById("guitar-photo-error").textContent="Прикрепите фото гитары.",t=!1);t&&(document.getElementById("success-message").textContent="Гитара успешно добавлена!",this.reset())});document.addEventListener("DOMContentLoaded",()=>{function s(t){n.forEach(n=>n.classList.remove("active"));n[t]&&n[t].classList.add("active")}function c(n){n.classList.remove("active")}function l(n){n.classList.add("active")}function u(n){fetch(`/Guitars/GetGuitarImage?guitarId=${h}&index=${n}`).then(n=>{if(!n.ok)throw new Error("Image not found");return n.json()}).then(t=>{c(r),setTimeout(()=>{r.src=t.imageUrl,i=n,l(r),s(n)},250)}).catch(n=>console.error("������ ��� �������� �����������:",n))}const f=document.querySelector(".prev-btn"),e=document.querySelector(".next-btn"),r=document.getElementById("carousel-image"),o=document.querySelector(".carousel-images"),n=document.querySelectorAll(".carousel-dot");n.forEach(n=>{n.addEventListener("click",n=>{const t=parseInt(n.target.dataset.index);t!==i&&u(t)})});const t=parseInt(o.dataset.total),h=o.dataset.guitarId;let i=0;t>1&&(f.style.display="block",e.style.display="block");e.addEventListener("click",()=>{const n=(i+1)%t;u(n)});f.addEventListener("click",()=>{const n=(i-1+t)%t;u(n)})});document.addEventListener("DOMContentLoaded",()=>{function f(){const n=parseFloat(c.value),i=parseFloat(l.value);return!isNaN(n)&&!isNaN(i)&&n>i?(t.style.display="block",!1):(t.style.display="none",!0)}async function u(){const i=new URLSearchParams(new FormData(r));i.append("page",n);i.append("pageSize",v);const u=await fetch(`/Guitars/GetFilteredGuitars?${i.toString()}`),t=await u.json();p(t.items);w(t.totalPages);y(t.minPrice,t.maxPrice)}function y(n,t){const i=document.getElementById("priceMin"),r=document.getElementById("priceMax");i.placeholder=`от ${n}`;r.placeholder=`до ${t}`}function p(n){if(i.innerHTML="",n.length===0){i.innerHTML="<p>Ничего не найдено.<\/p>";return}n.forEach(n=>{const t=document.createElement("a");t.href=`/Guitars/Show/${n.id}`;t.className="product-card-box";t.innerHTML=`
            <img src="/img/${n.guitarImageFileNames?.[0]}"
                 alt="${n.guitarBrand} ${n.guitarModel}" class="product-card-image" />
            <div class="product-card-info">
                <div>${n.guitarBrand} ${n.guitarModel}</div>
                <strong>${n.guitarPrice.toLocaleString()} ₽</strong>
                <p>Тип: ${n.guitarType}</p>
                <p>Бренд: ${n.guitarBrand}</p>
            </div>
        `;i.appendChild(t)})}function w(t){t<=1?h.style.display="none":(h.style.display="flex",a.textContent=n,o.disabled=n===1,s.disabled=n===t,o.onclick=()=>{n>1&&(n--,u())},s.onclick=()=>{n<t&&(n++,u())})}const r=document.getElementById("filter-form"),i=document.getElementById("catalog-container"),o=document.getElementById("prev-page-btn"),s=document.getElementById("next-page-btn"),a=document.getElementById("current-page"),h=document.querySelector(".pagination"),c=document.getElementById("priceMin"),l=document.getElementById("priceMax"),t=document.createElement("p");t.style.color="red";t.style.display="none";t.textContent="Минимальная цена не может быть больше максимальной!";r.insertBefore(t,r.querySelector("button, input[type='submit']"));c.addEventListener("input",f);l.addEventListener("input",f);let n=1;const v=1;i.addEventListener("mouseover",function(n){const t=n.target.closest(".product-card-box");t&&(t.style.transform="scale(1.05)",t.style.boxShadow="0 6px 20px rgba(0, 0, 0, 0.2)",t.style.backgroundColor="rgba(0, 0, 0, 0.05)")});i.addEventListener("mouseout",function(n){const t=n.target.closest(".product-card-box");t&&(t.style.transform="scale(1)",t.style.boxShadow="",t.style.backgroundColor="")});r.addEventListener("submit",t=>{(t.preventDefault(),f())&&(n=1,u())});const e=document.getElementById("back-to-top");e&&(window.addEventListener("scroll",()=>{e.style.display=window.scrollY>300?"block":"none"}),e.addEventListener("click",()=>{window.scrollTo({top:0,behavior:"smooth"})}));u()});